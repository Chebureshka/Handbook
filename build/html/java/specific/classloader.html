

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ClassLoader &mdash; Handbook 2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="Proxy" href="proxy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Handbook
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Java</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../concurrency/concurrency.html">Java Concurrency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jit/jit.html">JIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gc/gc.html">GC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collections/collections.html">Java Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scala/collections/collections.html">Scala Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/io.html">Java I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/build.html">Системы сборки</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="specific.html">Java Specific Objects</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="proxy.html">Proxy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ClassLoader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Этапы загрузки классов</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Стандартные загрузчики</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Текущий загрузчик</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Ошибки загрузки классов</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="jmx.html">JMX</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Java Frameworks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../frameworks/logging/logging.html">Логирование</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Handbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="specific.html">Java Specific Objects</a> &raquo;</li>
        
      <li>ClassLoader</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/java/specific/classloader.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="classloader">
<h1>ClassLoader<a class="headerlink" href="#classloader" title="Permalink to this headline">¶</a></h1>
<p>Любой класс (экземпляр класса java.lang.Class в среде и .class файл в файловой системе), используемый в среде исполнения был так или иначе загружен каким-либо загрузчиком в Java</p>
<div class="section" id="id1">
<h2>Этапы загрузки классов<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Загрузка байт-кода из ресурсов и создание экземпляра класса Class. Загрузка базовых классов</p></li>
<li><p>Связывание (или линковка)</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Verification, происходит проверка корректности полученного байт-кода.</p></li>
<li><p>Preparation, выделение оперативной памяти под статические поля и инициализация их значениями по умолчанию.</p></li>
<li><p>Resolution, разрешение символьных ссылок типов, полей и методов.
Т.е. загрузка классов для типов полей/методов. Может быть в <code class="docutils literal notranslate"><span class="pre">ClassLoader.loadClass(name,</span> <span class="pre">boolean</span> <span class="pre">resolve)</span></code> указан способ ленивой загрузки указанных типов <code class="docutils literal notranslate"><span class="pre">(resolve</span> <span class="pre">=</span> <span class="pre">false)</span></code></p></li>
</ol>
</div></blockquote>
</li>
<li><p>Инициализация полученного объекта</p></li>
</ol>
</div>
<div class="section" id="id2">
<h2>Стандартные загрузчики<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Каждый загрузчик хранит указатель на родительский (Bootstrap -&gt; Extension Classloader -&gt; System Classloader) для того, чтобы смочь делегировать ему загрузку в том случае, если сам будет не в состоянии этого сделать.</p>
<p>Запрос на загрузку класса передается родительскому загрузчику, и попытка загрузить класс самостоятельно выполняется, только если родительский загрузчик не смог найти и загрузить класс.</p>
<p>Загрузчик видит только «свои» классы и классы «родителя» и понятия не имеет о классах, которые были загружены его «потомком».</p>
<p>Загрузка класса опрашивает загрузчики на присутствии загружаемого класса в кэше (в порядке от дочернего класса к родительсскому). А далее в обратном порядке каждый загрузчик пытается загрузить данный класс.</p>
<p>Загрузка классов происходит по мере необходимости определенным загрузчиком, отвечающим за определенную загружаемаю область (rt.jar $JAVA_HOME/lib/ext CLASSPATH)</p>
<dl class="simple">
<dt>Bootstrap</dt><dd><p>Реализован на уровне JVM и не имеет обратной связи со средой исполнения (<code class="docutils literal notranslate"><span class="pre">A.class.getClassLoader()</span> <span class="pre">==</span> <span class="pre">null</span></code> для классов из java.*).
Данным загрузчиком загружаются классы из директории $JAVA_HOME/lib (rt.jar).
Управлять загрузкой базовых классов можно с помощью ключа -Xbootclasspath, который позволяет переопределять наборы базовых классов.</p>
</dd>
<dt>Extension Classloader</dt><dd><p>Загрузчик расширений. Данный загрузчик загружает классы из директории $JAVA_HOME/lib/ext.</p>
</dd>
<dt>System Classloader</dt><dd><p>Реализованный на уровне JRE (напр. для SUN JRE sun.misc.Launcher$AppClassLoader).
Этим загрузчиком загружаются классы, пути к которым указаны в переменной окружения CLASSPATH.
Управлять загрузкой системных классов можно с помощью ключа -classpath или системной опцией java.class.path.</p>
</dd>
</dl>
</div>
<div class="section" id="id3">
<h2>Текущий загрузчик<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Текущий загрузчик используется по умолчанию для загрузки классов в процессе исполнения. В часности, при использовании метода <code class="docutils literal notranslate"><span class="pre">Class.forName(&quot;&quot;)/ClassLoader.loadClass(&quot;&quot;)</span></code> или при любой декларации класса, ранее не загруженного.</p>
<p>Каждый класс знает, каким загрузчиком он был загружен, и можно получить эту информацию, вызвав у него метод <code class="docutils literal notranslate"><span class="pre">String.class.getClassLoader()</span></code></p>
<p>Для всех классов приложения «текущий» загрузчик, как правило, системный.</p>
</div></blockquote>
</div>
<div class="section" id="id4">
<h2>Ошибки загрузки классов<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>ClassNotFoundException</dt><dd><p>Возникает при динамической загрузке класса во время выполнения программы, когда загрузчики не могут найти требуемый класс ни в кэше, ни по пути нахождения классов.</p>
<p>Например, при использовании рефлексии <code class="docutils literal notranslate"><span class="pre">(Class.forName(&quot;...&quot;))</span></code>, или же при десериализации объекта с отсутствующим классом.</p>
</dd>
<dt>NoClassDefFoundError</dt><dd><p>Возникает в том случае, когда во время компиляции искомый класс был доступен, но не виден во время выполнения программы.
(Искомое определение класса существовало при компиляции текущего класса, но при исполнении не может быть найдено)</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="references.html" class="btn btn-neutral float-right" title="References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="proxy.html" class="btn btn-neutral float-left" title="Proxy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Chebureshka 🥟❤️🥟

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>